copyright corpor reserv program accompani materi avail term eclips public licens accompani distribut avail http www eclips org legal epl html contributor corpor initi implement packag org eclips swt ole win import org eclips swt intern ole win import org eclips swt intern win ole autom provid generic mechan access function specif activ control document document activ control support dispatch interfac order provid ole autom support addit function provid object specifi file addit method properti valu code properti code set properti valu code set properti code invok method code invok code code invok repli code argument pass form code variant code object sampl fragment pre interfac control dispatch propget max file count retval int propput max file count int add file file pre exampl interact extend function shown code pre ole autom autom ole autom control site max file count paramet int rgdispid autom string max file count int max file count rgdispid set properti max file count autom set properti max file count variant system println max file count success set valu max file count paramet variant var result autom properti max file count var result null system println max file count var result int invok add file method add file method paramet rgdispid autom string add file file int disp member rgdispid int rgdispid arg int rgdispid convert argument variant object variant rgvarg variant string file testfil rgvarg variant file call method variant var result autom invok disp member rgvarg rgdispid arg check return valu var result null var result int system println fail add file file autom dispos pre code public final class ole autom privat dispatch obj dispatch privat string descript privat type info obj type info ole autom dispatch idispatch idispatch null error obj dispatch idispatch obj dispatch add ref int ppv int int result obj dispatch type info ppv result obj type info type info ppv obj type info add ref creat ole autom object specifi client param client site site document activ control addit function access illeg argument call invalid client site public ole autom ole client site client site client site null error obj dispatch client site autom object int ppv int int result obj dispatch type info ppv result obj type info type info ppv obj type info add ref dispos autom object method releas dispatch interfac document activ control ole autom object dispos public void dispos obj dispatch null obj dispatch releas obj dispatch null obj type info null obj type info releas obj type info null int address return obj dispatch address public string file int disp obj type info null return null string file string int obj type info document disp null null null file return file return null public string document int disp obj type info null return null string doc string int obj type info document disp null doc null null return doc return null public ole properti descript properti descript int index obj type info null return null int var desc int int obj type info var desc index var desc return null vardesc move memori vardesc var desc sizeof ole properti descript data ole properti descript data vardesc memid data vardesc memid data type vardesc elemdesc var tdesc data type short short move memori vardesc elemdesc var tdesc union data type data flag vardesc var flag data kind vardesc varkind data descript document vardesc memid data file file vardesc memid obj type info releas var desc var desc return data public ole function descript function descript int index obj type info null return null int func desc int int obj type info func desc index func desc return null funcdesc move memori funcdesc func desc sizeof ole function descript data ole function descript data funcdesc memid data option arg count funcdesc param opt data invok kind funcdesc invkind data func kind funcdesc funckind data flag funcdesc func flag data call convent funcdesc callconv data document document funcdesc memid data file file funcdesc memid string funcdesc memid funcdesc param length data data arg ole paramet descript funcdesc param int data arg length data arg ole paramet descript length data arg short short move memori funcdesc lprgelemdesc param int typedesc int move memori typedesc funcdesc lprgelemdesc param short short move memori typedesc short data arg type short param flag short move memori param flag funcdesc lprgelemdesc param data arg flag param flag data return type funcdesc elemdesc func tdesc data return type short short move memori funcdesc elemdesc func tdesc union data return type obj type info releas func desc func desc return data public type info attribut obj type info null return null int type attr int int obj type info type attr type attr return null typeattr move memori typeattr type attr sizeof obj type info releas type attr type attr return typeattr public string int disp obj type info null return null string string int obj type info document disp null null null return return null public string int disp int max size obj type info null return string string string max size int count int int obj type info disp max size count string string count system arraycopi count return return string return posit integ valu associ specifi dispatch implementor tri paramet method string array method follow paramet param array requir identifi return posit integ valu associ specifi order provid null unknown public int string int rgdispid int length int result obj dispatch length rgdispid result return null return rgdispid return descript error encount return descript error encount public string error return descript return valu properti specifi disp member param disp member properti specifi activ control valu obtain ole autom return valu properti specifi disp member null public variant properti int disp member variant var result variant int result invok disp member null null var result return result var result null return valu properti specifi disp member param disp member properti specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type return valu properti specifi disp member null sinc public variant properti int disp member variant rgvarg variant var result variant int result invok disp member rgvarg null var result return result var result null return valu properti specifi disp member param disp member properti specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type param rgdispid arg array identifi argument specifi rgvarg paramet order correspond valu argument identifi identifi obtain ole autom return valu properti specifi disp member null sinc public variant properti int disp member variant rgvarg int rgdispid arg variant var result variant int result invok disp member rgvarg rgdispid arg var result return result var result null invok method object method paramet param disp member method specifi activ control valu obtain ole autom return result method null method fail give result inform public variant invok int disp member variant var result variant int result invok disp member null null var result return result var result null invok method object method option paramet param disp member method specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type return result method null method fail give result inform public variant invok int disp member variant rgvarg variant var result variant int result invok disp member rgvarg null var result return result var result null invok method object method option paramet necessari specifi option paramet onli includ paramet provid valu param disp member method specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type param rgdispid arg array identifi argument specifi rgvarg paramet order correspond valu argument identifi identifi obtain ole autom return result method null method fail give result inform public variant invok int disp member variant rgvarg int rgdispid arg variant var result variant int result invok disp member rgvarg rgdispid arg var result return result var result null privat int invok int disp member int flag variant rgvarg int rgdispid arg variant var result dispatch interfac control obj dispatch null return creat structur input paramet disp param store argument rgvarg rgvarg null rgvarg length disp param arg rgvarg length disp param rgvarg global alloc variant sizeof rgvarg length int offset int rgvarg length rgvarg data disp param rgvarg offset offset variant sizeof argument id store id rgdispid arg rgdispid arg null rgdispid arg length disp param arg rgdispid arg length disp param rgdispid arg global alloc rgdispid arg length int offset int rgdispid arg length move memori disp param rgdispid arg offset int rgdispid arg offset invok method excep info int arg err int int var result address var result null var result address global alloc variant sizeof int result obj dispatch invok disp member flag disp param var result address excep info arg err var result address var result set data var result address variant clear var result address global free var result address free dispparam resourc disp param rgdispid arg global free disp param rgdispid arg disp param rgvarg int offset int length rgvarg length length variant clear disp param rgvarg offset offset variant sizeof global free disp param rgvarg save error string cleanup manag excepinfo result excep info return result invok method object method paramet earli day dispatch interfac defin applic main word support return valu applic call method call code public void invok int disp member code param disp member method specifi activ control valu obtain ole autom method invoc fail public void invok repli int disp member int result invok disp member null null null result error result invok method object method option paramet earli day dispatch interfac defin applic main word support return valu applic call method call code public void invok int disp member variant rgvarg code param disp member method specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type method invoc fail public void invok repli int disp member variant rgvarg int result invok disp member rgvarg null null result error result invok method object method option paramet necessari specifi option paramet onli includ paramet provid valu earli day dispatch interfac defin applic main word support return valu applic call method call code public void invok int disp member variant rgvarg int rgdispid arg code param disp member method specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type param rgdispid arg array identifi argument specifi rgvarg paramet order correspond valu argument identifi identifi obtain ole autom method invoc fail public void invok repli int disp member variant rgvarg int rgdispid arg int result invok disp member rgvarg rgdispid arg null result error result privat void manag excepinfo int result excep info result descript error return extract info result excep info bstr descript int size sys string byte len excep info bstr descript char buffer char size move memori buffer excep info bstr descript size descript string buffer els descript autom error excep info code descript code excep info code els excep info scode descript code excep info scode els descript autom error result result cleanup struct excep info bstr descript sys free string excep info bstr descript excep info bstr file sys free string excep info bstr file excep info bstr sourc sys free string excep info bstr sourc set properti specifi disp member valu param disp member properti specifi activ control valu obtain ole autom param rgvarg valu properti return true oper success public boolean set properti int disp member variant rgvarg variant rgvarg variant rgvarg int rgdispid arg int int flag rgvarg type flag variant var result variant int result invok disp member flag rgvarg rgdispid arg var result return result set properti specifi disp member valu param disp member properti specifi activ control valu obtain ole autom param rgvarg array argument method argument consid read onli variant refer variant type return true oper success sinc public boolean set properti int disp member variant rgvarg int rgdispid arg int int flag int rgvarg length rgvarg type flag variant var result variant int result invok disp member flag rgvarg rgdispid arg var result return result 