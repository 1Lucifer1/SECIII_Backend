copyright corpor reserv program accompani materi avail term eclips public licens accompani distribut avail http www eclips org legal epl html contributor corpor initi implement packag org eclips swt intern imag import org eclips swt import org eclips swt graphic import java final class win file format extend file format static final int file header size static final int header fix size int import color point pel meter point compress num byte byte imag data src store dest start techniqu specifi comp true indic line imag answer size compress data int compress int comp byte src int src offset int num byte byte dest boolean comp return compress data src src offset num byte dest comp return compress data src src offset num byte dest error return int compress data byte src int src offset int num byte byte dest boolean int src offset src offset num byte int size left byte byte find consecut byte left left left left src src break onli byte scan line includ left store interven data switch case break case handl separ becaus command dest byte pixel dest src size break default dest dest byte byte pixel dest src size pad word dest size break find length run store left left left left byte src left src byte break dest byte byte pixel dest byte size store line bitmap code dest dest els dest size return size int compress data byte src int src offset int num byte byte dest boolean int src offset src offset num byte int size left byte byte find consecut byte left left left left src src break onli byte scan line includ left store interven data switch case break case handl separ becaus command dest dest src size don break fall case handl separ becaus command dest dest src size break default dest dest byte dest src size pad word dest size break find length run store left left left left byte src left src byte break dest byte dest byte size store line bitmap code dest dest els dest size return size void decompress data byte src byte dest int stride int cmp cmp decompress data src src length stride dest dest length error return cmp decompress data src src length stride dest dest length error return error int decompress data byte src int num byte int stride byte dest int dest size int int num byte int int dest size int int len src len len src switch len case line stride return break case bitmap return case delta src src stride return break default absolut mode run len odd run length current support return len len len len return len return int len dest src word align break els len return len len len byte byte src len return int len dest byte return int decompress data byte src int num byte int stride byte dest int dest size int int num byte int int dest size int int len src len len src switch len case line stride return break case bitmap return case delta src src stride return break default absolut mode run len return len return int len dest src word align len break els byte byte src len return int len dest byte len return boolean file format data input stream stream tri byte header byte stream read header stream unread header int info header size header header header header return header header info header size header fix size catch return fals byte load data byte info header int width info header info header info header info header int height info header info header info header info header int bit count info header info header int stride width bit count stride stride byte multipl byte data load data info header stride flip scan line data stride height return data byte load data byte info header int stride int height info header info header info header info header int data size height stride byte data byte data size int cmp info header info header info header info header cmp tri input stream read data data size error catch error els int compress size info header info header info header info header byte compress byte compress size tri input stream read compress compress size error catch error decompress data compress data stride cmp return data int load file header int header int tri header input stream read short header input stream read int header input stream read short header input stream read short header input stream read int catch error header error return header imag data load byte stream int file header load file header byte info header byte header fix size tri input stream read info header catch error int width info header info header info header info header int height info header info header info header info header int bit count info header info header palett data palett load palett info header input stream posit file header seek specifi offset tri input stream skip file header input stream posit catch error byte data load data info header compress info header info header info header info header import color info header info header info header info header int pel meter info header info header info header info header int pel meter info header info header info header info header pel meter point pel meter pel meter int type compress compress return imag data imag data intern width height bit count palett data null null type palett data load palett byte info header int depth info header info header depth int num color info header info header info header info header num color num color depth els num color num color byte buf byte num color tri input stream read buf buf length error catch error return palett byte buf num color depth return palett data depth return palett data return palett data palett data palett byte byte byte int num color int byte offset color num color int num color color byte byte offset byte byte offset byte byte offset byte offset return palett data color answer byte array represent devic independ palett static byte palett byte palett data pal int pal color null pal color length pal color length byte byte byte int offset int col pal color byte offset byte col blue byte offset byte col green byte offset byte col red offset return byte unload imag data byte stream compress strategi answer number byte written int unload data imag data imag output stream int comp int total size tri comp return unload data compress imag int bpl imag width imag depth int bmp bpl bpl pad scanlin multipl byte int imag bpl imag byte line compress actual space worst case byte buf byte bmp bpl int src offset imag bpl imag height start line byte data imag data total size byte buf byte int buf offset int imag height int line size compress comp data src offset bpl buf buf offset line size buf length write buf buf offset buf offset system arraycopi buf buf buf offset line size buf offset line size total size line size src offset imag bpl buf offset write buf buf offset catch error return total size prepar imag data unload byte stream compress strategi answer number byte written int unload data compress imag data imag output stream int bmp bpl tri int bpl imag width imag depth bmp bpl bpl pad scanlin multipl byte int line buf bmp bpl byte buf byte line buf bmp bpl byte data imag data int imag bpl imag byte line int data index imag bpl imag height start line imag depth int imag height line buf int count imag height line buf count count line buf int buf offset int count int index index bpl index buf buf offset index data data index index buf buf offset index data data index index buf offset bmp bpl data index imag bpl write buf buf offset els int imag height line buf int tmp imag height int count tmp line buf tmp line buf int buf offset int count system arraycopi data data index buf buf offset bpl buf offset bmp bpl data index imag bpl write buf buf offset catch error return bmp bpl imag height unload devic independ imag window format byte stream void unload byte stream imag data imag byte rgbs int num col imag depth imag depth imag depth imag depth imag depth imag depth error int comp compress comp comp imag depth comp imag depth error palett data pal imag palett imag depth imag depth imag depth pal direct error num col rgbs null els pal direct error num col pal color length rgbs palett byte pal fill file header bfsize int header size file header size header fix size int file header int file header signatur file header file size fill file header reserv file header reserv file header header size offset data rgbs null file header rgbs length prepar data don tri rewind stream fill detail byte array output stream byte array output stream unload data imag comp byte data byte array calcul file size file header file header data length write header tri output stream write short file header output stream write int file header output stream write short file header output stream write short file header output stream write int file header catch error tri output stream write int header fix size output stream write int imag width output stream write int imag height output stream write short output stream write short short imag depth output stream write int comp output stream write int data length output stream write int pel meter output stream write int pel meter output stream write int num col output stream write int import color catch error unload palett num col tri output stream write rgbs catch error unload data tri output stream write data catch error void flip scan line byte data int stride int height int int height stride int height int index index stride index byte data index data index data index data index stride stride 