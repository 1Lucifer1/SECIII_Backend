copyright corpor reserv program accompani materi avail term eclips public licens accompani distribut avail http www eclips org legal epl html contributor corpor initi implement packag org eclips swt intern import java util hashtabl import org eclips swt import org eclips swt graphic import org eclips swt intern win wrap win bidi enabl style text widget public class bidi util keyboard languag id public static final int public static final int bidi flag static int bidi platform render info flag valu public static final int public static final int public static final int variabl provid listen mechan keyboard languag switch static hashtabl languag map hashtabl static hashtabl key map hashtabl static hashtabl proc map hashtabl code intent comment order support class becaus doe compil java compil target static callback callback callback bidi util class window proc static final string org eclips swt intern bidi util static callback callback static tri callback callback class window proc callback address error catch class charact placement constant static final int static final int static final int static final int static final byte static final byte static final byte static final byte static final int static final int ext text constant static final int static final int window primari languag identifi static final int static final int code page identifi static final string static final string activ keyboard constant static final int static final int public charact class constant window platform constant save convers class array render info arbitrari constant public static final int public static final int public static final int public static final int public static final int public static final int public static final int add languag listen listen notifi languag keyboard chang alt shift win platform creat window proc control window messag control monitor param hwnd handl control listen keyboard languag chang param runnabl code execut keyboard languag chang occur public static void add languag listen int hwnd runnabl runnabl languag map put integ hwnd runnabl subclass hwnd proc enum system languag group call dure bidi platform test static int enum system languag group proc int lang grp int lang grp string int lang grp int option int param lang grp bidi platform return lang grp bidi platform return return wrap ext text function param render param render buffer glyph render array charact param render width glyph render buffer param posit start render param posit start render public static void draw glyph char render buffer int render int int int length render length win layout handl revers render render length fix bug revers render buffer render transpar avoid overlap segment fix bug int mode set mode handl ext text handl null render buffer render buffer length render set mode handl mode return order render inform text wrap font languag info charact placement function param measur line input paramet param text text bidi data calcul input paramet param order array integ repres visual posit charact text array output paramet param class buffer array integ repres type charact text array input output paramet param array integ repres pixel width glyph return glyph buffer output paramtet param flag integ repres render flag inform input paramet param offset text segment measur reorder separ input paramet org eclips swt custom bidi segment event detail return buffer glyph render text public static char render info string text int order byte class buffer int int flag int offset int font languag info font languag info handl int heap process heap int int int text charset handl boolean orient fals win orient layout handl translat charset info text buffer text fals int byte count text buffer length boolean link befor flag boolean link flag result result struct size sizeof result glyph byte count int order result order heap alloc heap byte count int result heap alloc heap byte count int class result class heap alloc heap byte count int glyph result glyph heap alloc heap byte count set requir flag int flag int glyph flag alway reorder assum call function platform support bidi fix flag font languag info flag glyph flag font languag info flag link befor glyph flag link glyph flag byte glyph link befor link glyph byte glyph byte glyph flag glyph byte glyph flag els glyph byte byte glyph flag move memori result glyph glyph glyph length flag set classif valu substr flag move memori result class class buffer class buffer length char glyph buffer char result glyph int glyph count int offset length int offset offset int length offset offset number glyph expect length segment length actual number return case arab ligatur result glyph length text buffer text substr offset offset length fals charact placement handl text buffer text buffer length result flag null int int result glyph move memori result length orient revers system arraycopi glyph count length order null int order int length move memori order result order order length translat order order glyph count orient system arraycopi order order offset length class buffer null byte class buffer byte length move memori class buffer result class class buffer length system arraycopi class buffer class buffer offset length char glyph buffer char result glyph move memori glyph buffer result glyph glyph buffer length orient revers glyph buffer system arraycopi glyph buffer glyph buffer glyph count glyph buffer length glyph count glyph buffer length concaten success result call arab onli good method sinc number output glyph number input charact assum line built success adjac segment overlap result order length result length result class length result glyph glyph buffer length free memori alloc heap free heap glyph heap free heap class heap free heap heap free heap order return glyph buffer return bidi order inform text doe return render inform glyph glyph distanc method onli order inform improv perform wrap font languag info charact placement function param measur line input paramet param text text bidi data calcul input paramet param order array integ repres visual posit charact text array output paramet param class buffer array integ repres type charact text array input output paramet param flag integ repres render flag inform input paramet param offset text segment measur reorder separ input paramet org eclips swt custom bidi segment event detail public static void order info string text int order byte class buffer int flag int offset int font languag info font languag info handl int heap process heap int int int text charset handl translat charset info text buffer text fals int byte count text buffer length boolean orient fals win orient layout handl result result struct size sizeof result glyph byte count int order result order heap alloc heap byte count int class result class heap alloc heap byte count set requir flag valu affect text render order int flag alway reorder assum call function platform support bidi fix flag font languag info flag font languag info flag flag set classif valu substr classif valu specifi input flag move memori result class class buffer class buffer length int glyph count int offset length int offset offset int length offset offset number glyph expect length segment length actual number return case arab ligatur result glyph length text buffer text substr offset offset length fals charact placement handl text buffer text buffer length result flag order null int order int length move memori order result order order length translat order order glyph count orient system arraycopi order order offset length class buffer null byte class buffer byte length move memori class buffer result class class buffer length system arraycopi class buffer class buffer offset length glyph count result glyph concaten success result call arab onli good method sinc number output glyph number input charact assum line built success adjac segment overlap result order length result class length free memori alloc heap free heap class heap free heap order return bidi attribut inform font specifi param queri return bitwis flag defin class public static int font bidi attribut int font style int font languag info font languag info handl font languag info font style font languag info font style font languag info font style return font style return activ keyboard languag type return integ repres activ keyboard languag public static int keyboard languag int layout keyboard layout onli interest byte primari languag identifi layout layout layout return layout return return bidi languag return return languag instal keyboard return integ array entri instal languag static int keyboard languag list int max size int temp list int max size int size keyboard layout list max size temp list int list int size system arraycopi temp list list size return list return platform support bidi languag determin languag instal return true bidi support fals otherwis alway fals window public static boolean bidi platform win return fals bidi platform return bidi platform alreadi set bidi platform follow test workaround bug report win bidi complex script thai languag instal time sinc bidi platform call support doubl byte charact run eclips complex script languag constrain test answer true onli bidi input languag defin complex script languag work instal bidi complex script languag onli instal thai keyboard keyboard bidi return fals callback callback null tri callback callback class enum system languag group proc int enum system languag group proc callback address enum system languag group proc error enum system languag group enum system languag group proc callback dispos catch class callback null callback dispos bidi platform return true system code page platform sinc enum system languag group support platform string code page string valu equal code page equal code page bidi platform return bidi platform return keyboard support input bidi languag determin languag instal keyboard return true bidi support fals otherwis public static boolean keyboard bidi int list keyboard languag list int list length int list return true return fals remov specifi languag listen param hwnd handl control listen keyboard languag chang public static void remov languag listen int hwnd languag map remov integ hwnd unsubclass hwnd switch keyboard languag specifi languag type distinguish mulitpl bidi multipl bidi languag set keyboard languag type param languag integ repres languag public static void set keyboard languag int languag don switch keyboard doesn languag keyboard languag return languag list activ languag int list keyboard languag list set bidi languag int list length int list activ keyboard layout list return els list activ languag int list keyboard languag list set bidi languag anyth hebrew arab int list length int list activ keyboard layout list return set orient write order specifi control text align left write order param hwnd handl control chang orient param orient return true orient chang fals orient chang public static boolean set orient int hwnd int orient win return fals return fals int bit window long hwnd orient bit els bit set window long hwnd bit return true overrid window proc param hwnd control overrid window proc static void subclass int hwnd integ key integ hwnd proc map key null int proc window long hwnd proc map put key integ proc set window long hwnd callback address revers charact array orient param char array charact array revers static void revers char char array int length char array length int length char tmp char array char array char array length char array length tmp revers integ array orient param int array integ array revers static void revers int int array int length int array length int length int tmp int array int array int array length int array length tmp adjust order array relat start line revers order array orient param order array integ array order valu translat param glyph count number glyph process current line param orient flag indic current orient static void translat order int order array int glyph count boolean orient int max order int length order array length orient int length max order math max max order order array int length orient order array max order order array order array glyph count remov overridden window proc param hwnd control remov window proc overrid static void unsubclass int hwnd integ key integ hwnd languag map key null key map key null integ proc integ proc map remov key proc null return set window long hwnd proc int valu window proc intercept keyboard languag switch event widget orient chang run control regist runnabl keyboard languag switch param hwnd handl control listen keyboard languag chang event param msg window messag static int window proc int hwnd int msg int param int param integ key integ hwnd switch msg case runnabl runnabl runnabl languag map key runnabl null runnabl run break integ proc integ proc map key return call window proc proc int valu hwnd msg param param 