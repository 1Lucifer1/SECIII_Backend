copyright corpor reserv program accompani materi avail term eclips public licens accompani distribut avail http www eclips org legal epl html contributor corpor initi implement packag org eclips swt ole win import java file import java file output stream import java file input stream import java import org eclips swt import org eclips swt intern compat import org eclips swt intern ole win import org eclips swt graphic import org eclips swt widget import org eclips swt intern win ole client site provid site manag embed document ole client site provid follow capabl creat place editor blank document open exist document lay editor provid mechan activ deactiv document provid mechan save chang document object implement interfac unknown ole client site advis sink ole place site note class subclass code composit code doe sens add code control code children set layout style event dispos move resiz public class ole client site extend composit interfac ole client privat object unknown privat object ole client site privat object advis sink privat object ole place site privat object ole document site protect app clsid privat obj clsid privat int ref count refer associ frame protect ole frame frame access embed link ole object protect unknown obj unknown protect ole object obj ole object protect view object obj view object protect ole place object obj ole place object protect ole command target obj ole command target protect ole document view obj document view relat storag inform protect storag temp storag storag interfac receiv intern state style inform privat int aspect display aspect embed object dvaspect content dvaspect icon privat int type indic type client support insid privat boolean static indic item display static bitmap metafil privat border width privat indent privat boolean updat fals privat boolean init true privat boolean dispos fals privat static final string word document privat listen listen static final int static final int static final int static final int static final int int state protect ole client site composit parent int style constructor becaus doe creat ole object super parent style creat interfac instal ole frame client site parent null parent instanceof ole frame frame ole frame parent break parent parent parent frame null error frame add ref aspect type static fals listen listen public void handl event event switch type case resiz case move resiz break case dispos dispos break case focus focus break case focus focus break case paint paint break case travers travers break case key requir travers break default error frame add listen resiz listen frame add listen move listen add listen dispos listen add listen focus listen add listen focus listen add listen paint listen add listen travers listen add listen key listen creat ole client site child widget document type associ specifi file document type determin header inform file registri entri file extens style bit select set properti param parent composit widget ole frame param style bitwis ing widget style param file file open document illeg argument parent null parent ole frame call wrong thread fail creat object fail open file unabl creat callback interfac public ole client site composit parent int style file file parent style tri file null file directori file exist error associ app clsid char file file absolut path char array int result class file file app clsid result error result associ instal machin program null error result open temporari storag object temp storag creat temp storag creat ole object storag object int address int result ole creat file app clsid file unknown null temp storag address address result error result obj unknown unknown address init sink add object refer ole run obj unknown address state catch dispos dispos interfac throw creat ole client site child widget edit blank document specifi document applic style bit select set properti param parent composit widget ole frame param style bitwis ing widget style param prog uniqu program identifi document applic valu prog key valu version independ prog key specifi registri desir document exampl version independ prog word word document illeg argument parent null parent ole frame call wrong thread prog doe map regist fail creat object public ole client site composit parent int style string prog parent style tri app clsid class prog app clsid null error open temporari storag object temp storag creat temp storag creat ole object storag object int address int int result ole creat app clsid unknown null temp storag address address result error result obj unknown unknown address init sink add object refer ole run obj unknown address state catch dispos dispos interfac throw creat ole client site child widget edit specifi file specifi document applic style bit select set properti method part public code ole client site code mark public onli share packag provid avail platform call applic code param parent composit widget ole frame param style bitwis ing widget style param prog uniqu program identifi document applic valu prog key valu version independ prog key specifi registri desir document exampl version independ prog word word document param file file open document illeg argument parent null parent ole frame call wrong thread prog doe map regist fail creat object fail open file public ole client site composit parent int style string prog file file parent style tri file null file directori file exist error app clsid class prog open file prefer object char file file absolut path char array file clsid class file file file clsid equal app clsid file clsid applic creat file therefor default mechan temp storag creat temp storag creat ole object storag object int address int int result ole creat file app clsid file unknown null temp storag address address result error result obj unknown unknown address els applic creat file therefor copi origin file storag file storag storag null stg storag file file int address int int mode int result stg open storag file mode address doe add ref success result error result storag storag address els origin file storag file copi content stream storag file int address int int mode int result stg creat docfil null mode address increment ref count success result error result storag storag address creat stream storag object word doe follow standard doe primari stream string stream word class equal app clsid word stream word document address int result storag creat stream stream mode address increment ref count success result storag releas error result stream stream stream address tri copi data file stream file input stream file input file input stream file int increment byte buffer byte increment int count count file input read buffer int task mem alloc count move memori buffer count result stream write count null task mem free result file input close stream releas storag releas error result file input close stream commit stream releas catch err stream releas storag releas error open temporari storag object temp storag creat temp storag copi content file int result storag copi null null temp storag address storag releas result error result creat ole client int ppv int result creat instanc app clsid unknown ppv result error result obj unknown unknown ppv persist storag ole client ppv int result obj unknown queri interfac persist storag ppv result error result persist storag persist storag persist storag ppv load content file ole client site result persist storag load temp storag address persist storag releas result error result init sink add object refer ole run obj unknown address state catch dispos dispos interfac throw protect void add object refer int ppv object int obj unknown queri interfac persist ppv object persist obj persist persist ppv object tempid obj persist class tempid obj clsid tempid obj persist releas ppv object int int result obj unknown queri interfac view object ppv object result error result obj view object view object ppv object obj view object set advis aspect advis sink address ppv object int result obj unknown queri interfac ole object ppv object result error result obj ole object ole object ppv object obj ole object set client site ole client site address int pdw connect int obj ole object advis advis sink address pdw connect obj ole object set host main main notifi control object embed ole set object obj unknown address true object link embed ppv object int obj unknown queri interfac ole link ppv object ole link obj ole link ole link ppv object int ppmk int obj ole link sourc monik ppmk monik obj monik monik ppmk obj monik releas type obj ole link bind run els static true obj ole link releas protect int add ref ref count return ref count privat int place activ aspect type return return privat int context sensit int enter mode return protect void creat interfac unknown object int public int method int arg return queri interfac arg arg public int method int arg return add ref public int method int arg return releas ole client site object int public int method int arg return queri interfac arg arg public int method int arg return add ref public int method int arg return releas public int method int arg return save object method monik implement public int method int arg return arg public int method int arg return show object public int method int arg return show window arg method request object layout implement advis sink object int public int method int arg return queri interfac arg arg public int method int arg return add ref public int method int arg return releas public int method int arg return data chang arg arg public int method int arg return view chang arg arg method renam implement public int method int arg save return public int method int arg return close ole place site object int public int method int arg return queri interfac arg arg public int method int arg return add ref public int method int arg return releas public int method int arg return window arg public int method int arg return context sensit arg public int method int arg return place activ public int method int arg return place activ public int method int arg return activ public int method int arg return window context arg arg arg arg arg public int method int arg return scroll arg public int method int arg return deactiv arg public int method int arg return place deactiv method discard undo state implement method deactiv undo chang implement public int method int arg return pos rect chang arg ole document site object int public int method int arg return queri interfac arg arg public int method int arg return add ref public int method int arg return releas public int method int arg return activ arg protect storag creat temp storag int temp storag int int grf mode int result stg creat docfil null grf mode temp storag result error result return storag temp storag deactiv activ place object discard object undo state public void deactiv place client obj ole place object null obj ole place object place deactiv privat void delet temp storag destroy item content temp root storag temp storag null temp storag releas temp storag null protect void dispos interfac unknown null unknown dispos unknown null ole client site null ole client site dispos ole client site null advis sink null advis sink dispos advis sink null ole place site null ole place site dispos ole place site null ole document site null ole document site dispos ole document site null request document activ control perform action action alway chang activ state param verb oper request valu return valu indic success oper request indic success public int verb int verb client exampl power point set run state constructor fix ensur client run state befor invok ani verb state ole run obj unknown address state state static return int result obj ole object verb verb null ole client site address handl null state init updat storag init fals return result document activ control execut command standard list command document activ control support ole command target interfac document activ control doe support command standard list check command support call queri status cmd param cmd command valu small set common command param option option flag valu param argument command param return valu command return valu return success public int exec int cmd int option variant variant obj ole command target null int address int obj unknown queri interfac ole command target address return obj ole command target ole command target address int address null address global alloc variant sizeof data address int address null address global alloc variant sizeof data address int result obj ole command target exec null cmd option address address address variant clear address global free address address set data address variant clear address global free address return result dispatch autom object int ppv object int obj unknown queri interfac dispatch ppv object return null return dispatch ppv object protect class string client creat struct hold result guid creat null termin array char char buffer null client null int count client length buffer char count client char count buffer prog buffer guid int result string buffer guid result error result return guid privat int int simpl support link embed object probabl implement method return set move memori int return privat extent sizel current size embed nativ object obj ole object null obj view object null ole run obj ole object address obj view object extent aspect null sizel els obj ole object extent aspect sizel return form himetr pixel sizel public rectangl indent return rectangl indent left indent indent top indent bottom return program document activ control return program document activ control public string program app clsid null int lplpsz prog int prog app clsid lplpsz prog int mem lplpsz prog int length global size mem int ptr global lock mem char buffer char length move memori buffer ptr length global unlock mem global free mem string result string buffer remov null termin int index result index return result substr index return null int activ int view activ view activ int ppv object int obj unknown queri interfac ole document ppv object return ole document obj ole document ole document ppv object obj ole document creat view ole place site address ppv object return obj ole document releas obj document view ole document view ppv object els obj document view ole document view view activ obj document view add ref obj document view set place site ole place site address obj document view activ rect rect obj document view set rect rect obj document view show return protect int window int phwnd phwnd return frame null move memori phwnd int return copi window handl memori pass move memori phwnd int frame handl return rect point locat locat rectangl area frame client area rect rect left locat rect top locat rect locat area width border width left border width rect bottom locat area height border width top border width bottom return rect privat int window context int frame int doc int lprc pos rect int lprc clip rect int frame info frame null frame return fill frame handl int ole place frame frame ole place frame move memori frame int ole place frame frame add ref null document handl doc move memori doc int fill posit clip info rect rect lprc pos rect move memori lprc pos rect rect sizeof lprc clip rect move memori lprc clip rect rect sizeof frame info frame info frame info sizeof frame info app frame info hwnd frame frame handl shell shell shell menu menubar shell menu bar menubar null menubar dispos int hwnd shell handl int accel send messag hwnd accel int accel send messag hwnd accel frame info accel entri accel frame info haccel accel move memori frame info frame info sizeof return public boolean dirti note method return true absolut clear content ole document differ content file file system access persist storag mechan int address int obj ole object queri interfac persist file address return true persist storag perm storag persist storag address content perman storag differ file int result perm storag dirti perm storag releas result return fals return true public boolean focus control check widget int focus hwnd focus obj ole place object null return handl focus hwnd int phwnd int obj ole place object window phwnd focus hwnd phwnd focus hwnd return true focus hwnd parent focus hwnd return fals privat int close return privat int data chang int formatetc int stgmed return privat void dispos event dispos true state verb deactiv place client releas object interfac note releas object interfac befor releas frame delet temp storag remov listen remov listen dispos listen remov listen focus listen remov listen paint listen remov listen travers listen remov listen key listen frame remov listen resiz listen frame remov listen move listen frame releas frame null void focus event dispos return state verb obj ole place object null return focus control return int phwnd int obj ole place object window phwnd phwnd return set focus phwnd void focus event privat int place activ state frame set current document obj ole object null return int ppv object int obj ole object queri interfac ole place object ppv object obj ole place object ole place object ppv object return privat int place deactiv obj ole place object null obj ole place object releas obj ole place object null state redraw shell shell shell focus control frame focus control shell travers return privat int pos rect chang int lprc pos rect point size size set extent size size return privat void paint event state state size extent rectangl area client area rect program start excel sheet rect left area rect area area height size size rect top area rect bottom area area height els rect left area rect area size rect top area rect bottom area size int area global alloc sizeof move memori area rect sizeof ole draw obj unknown address aspect handl area global free area privat void resiz event rectangl area frame client area set bound border width left border width top area width border width left border width area height border width top border width bottom set object rect privat void save privat int show window int show return privat int activ obj ole place object null return state int phwnd int obj ole place object window phwnd set window pos phwnd return privat int deactiv int undoabl current ignor undoabl flag frame null frame dispos return state frame set activ object redraw shell shell shell focus control frame focus control shell travers menu menubar shell menu bar menubar null menubar dispos return int shell handl shell handl set menu shell handl menubar handl return ole set menu descriptor shell handl privat void travers event event switch event detail case case case case case case case event doit true break privat int view chang int aspect int lindex return protect int queri interfac int riid int ppv object riid ppv object return guid move memori guid riid sizeof equal guid unknown move memori ppv object int unknown address add ref return equal guid advis sink move memori ppv object int advis sink address add ref return equal guid ole client site move memori ppv object int ole client site address add ref return equal guid ole place site move memori ppv object int ole place site address add ref return bug equal guid ole document site string prog program prog start power point move memori ppv object int ole document site address add ref return move memori ppv object int return return status specifi command status ani bitwis combin queri status command befor invok ole client site exec document activ control support ole command target method param cmd command valu small set common command return status specifi command unabl queri object valu public int queri status int cmd obj ole command target null int address int obj unknown queri interfac ole command target address return obj ole command target ole command target address olecmd olecmd cmd cmd int result obj ole command target queri status null olecmd null result return return olecmd cmdf protect int releas ref count ref count dispos interfac return ref count protect void releas object interfac obj ole place object null obj ole place object releas obj ole place object null obj ole object null obj ole object close obj ole object releas obj ole object null obj document view null obj document view releas obj document view null obj view object null obj view object set advis aspect obj view object releas obj view object null obj ole command target null obj ole command target releas obj ole command target null obj unknown null obj unknown releas obj unknown null free unus librari public boolean save file file boolean includ ole info includ ole info return save storag file file return save tradit file file privat boolean save content int address file file boolean success fals stream temp content stream address temp content add ref tri file output stream writer file output stream file int increment int task mem alloc increment int pcb written int temp content read increment pcb written pcb written byte buffer byte pcb written move memori buffer pcb written writer write buffer note file doe exist creat file time call success true task mem free writer close catch err temp content releas return success privat boolean save ole nativ int address file file boolean success fals stream temp content stream address temp content add ref ole nativ stream header valu length nativ data follow int task mem alloc int size int int temp content read null move memori size task mem free size read data byte buffer byte size task mem alloc size temp content read size null move memori buffer size task mem free open file write data tri file output stream writer file output stream file writer write buffer note file doe exist creat file writer close success true catch err temp content releas return success privat int save object updat storag return save document specifi file includ spcific inforrm method onli file storag format exampl word file edit word document save method becaus format inform store specif storag format param file file chang save return true save success privat boolean save storag file file file file save format current applic format applic origin creat file excel file open word word applic save file word format note file alreadi exist applic overwrit file case delet file probabl save content file case save fail file null file directori return fals updat storag return fals access persist storag mechan int address int obj ole object queri interfac persist storag address return fals persist storag perm storag persist storag address tri address int char path file absolut path char array int mode int result stg creat docfil path mode address doe add ref success result return fals storag storag storag address tri ole save perm storag address storag address fals storag commit return true final storag releas final perm storag releas return fals save document specifi file method file storag format exampl bitmap file edit paint save method becaus bitmap standard format doe includ ani specif data param file file chang save return true save success privat boolean save tradit file file file note file alreadi exist applic overwrit file case delet file probabl save content file case save fail file null file directori return fals updat storag return fals int address int stream temp storag open stream address return save content address file ole object stream temp storag open stream ole nativ address return save ole nativ address file return fals privat int scroll int scroll extant return void set border space borderwidth border width borderwidth readjust size locat client site rectangl area frame client area set bound border width left border width top area width border width left border width area height border width top border width bottom set object rect privat void set extent int width int height resiz width height embed link nativ object specifi valu obj ole object null static updat return current extent extent width current extent height current extent return extent extent width extent height extent form pixel himetr extent server run set extent show boolean alreadi run ole run obj ole object address alreadi run ole run obj ole object address obj ole object set extent aspect extent updat true obj ole object updat updat fals alreadi run close server wasn alreadi run enter method obj ole object close public void set indent rectangl indent indent indent left indent indent indent width indent top indent indent bottom indent height privat void set object rect obj ole place object null return size object fill avail space leav border rect rect obj ole place object set object rect rect rect privat int show object posit object visibl user method ensur visibl minim return display dialog properti inform object document activ control support specifi properti page interfac param titl titlebar dialog public void show properti string titl properti page inform object int ppv object int obj unknown queri interfac specifi properti page ppv object return specifi properti page obj specifi properti page ppv object int result obj page obj releas result return creat frame display page char titl null titl null titl char titl length titl char titl length titl result ole creat properti frame frame handl titl int obj unknown address elem elem free properti page inform task mem free elem privat boolean updat storag temp storag null return fals int ppv int obj unknown queri interfac persist storag ppv return fals persist storag persist storag persist storag ppv int result ole save persist storag address temp storag address true result ole save fail static object ole save doe write class stg temp storag address obj clsid result persist storag save temp storag address true temp storag commit result persist storag save complet persist storag releas return true privat form himetr pixel size return size pixel transform size unit int int xppi devic cap logic pixel inch int yppi devic cap logic pixel inch releas int compat size xppi unit inch int compat size yppi size size size return size privat form pixel himetr size return size transform size pixel unit int int xppi devic cap logic pixel inch int yppi devic cap logic pixel inch releas int compat size xppi unit inch int compat size yppi size size size return size 