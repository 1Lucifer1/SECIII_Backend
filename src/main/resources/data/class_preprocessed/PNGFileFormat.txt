copyright corpor reserv program accompani materi avail term eclips public licens accompani distribut avail http www eclips org legal epl html contributor corpor initi implement packag org eclips swt intern imag import java import org eclips swt import org eclips swt graphic final class file format extend file format static final int png decod data stream decod stream png ihdr chunk header chunk png plte chunk palett chunk imag data imag data byte data byte alpha palett skip signatur data alreadi verifi file void read signatur throw byte signatur byte input stream read signatur load imag byte stream imag data load byte stream tri read signatur png chunk reader chunk reader png chunk reader input stream header chunk chunk reader ihdr chunk int imag size align byte row header chunk height data byte imag size imag data imag data intern header chunk width header chunk height header chunk swt bit pixel palett data data null null header chunk direct color imag data palett header chunk palett data read process chunk chunk encount chunk reader chunk read chunk chunk reader return imag data imag data catch error return null read handl chunk data file void read chunk png chunk reader chunk reader png chunk chunk chunk reader read chunk switch chunk chunk type case png chunk break case png chunk header chunk direct color palett chunk png plte chunk chunk imag data palett palett chunk palett data break case png chunk png trns chunk trns chunk png trns chunk chunk trns chunk transpar type header chunk png trns chunk imag data transpar pixel trns chunk swt transpar pixel header chunk els alpha palett trns chunk alpha valu header chunk palett chunk int transpar count transpar pixel int alpha palett length alpha palett transpar count transpar pixel transpar count alpha palett null els transpar count alpha palett transpar pixel alpha palett null imag data transpar pixel transpar pixel break case png chunk chunk reader read pixel data chunk imag file sequenti pixel data alreadi read anoth block encount invalid imag error els read pixel data imag imag chunk png idat chunk data chunk png idat chunk chunk read pixel data data chunk chunk reader break default chunk critic critic chunk support error void unload byte stream imag data error boolean file format data input stream stream tri byte signatur byte stream read signatur stream unread signatur signatur return fals signatur return fals signatur return fals signatur return fals signatur return fals signatur return fals signatur return fals signatur return fals return true catch return fals doe support bit depth imag bit depth convert data bit depth byte valid bit depth byte data header chunk bit depth byte result byte data length compress bit depth bit depth data result result length return result els return data doe support greyscal color type plain grayscal creat palett grayscal alpha howev convert pixel valu note method assum bit depth data alreadi restrict void set pixel data byte data imag data imag data switch header chunk color type case png ihdr chunk int width imag data width int height imag data height int dest byte line imag data byte line imag bit depth convert bit depth imag int src byte line align byte row header chunk bit depth src byte line byte rgb data byte dest byte line height byte alpha data byte width height int height int src index src byte line int dest index dest byte line int dest alpha index width int width byte grey data src index byte alpha data src index rgb data dest index grey rgb data dest index grey rgb data dest index grey alpha data dest alpha index alpha src index dest index dest alpha index imag data data rgb data imag data alpha data alpha data break case png ihdr chunk int width imag data width int height imag data height int dest byte line imag data byte line int src byte line align byte row imag bit depth convert bit depth imag header chunk bit depth src byte line byte rgb data byte dest byte line height byte alpha data byte width height int height int src index src byte line int dest index dest byte line int dest alpha index width int width rgb data dest index data src index rgb data dest index data src index rgb data dest index data src index alpha data dest alpha index data src index src index dest index dest alpha index imag data data rgb data imag data alpha data alpha data break case png ihdr chunk imag data data data break case png ihdr chunk imag data data data alpha palett null int size imag data width imag data height byte alpha data byte size byte pixel data byte size imag data pixel size pixel data int pixel data length alpha data alpha palett pixel data imag data alpha data alpha data break default imag data data data break support color type bit depth unsupport imag unsupport color type gray scale type bit depth convert data support format assign data imag data void set imag data valu byte data imag data imag data byte result valid bit depth data set pixel data result imag data read imag data data stream handl decod data filter interlac void read pixel data png idat chunk chunk png chunk reader chunk reader decod stream png decod data stream chunk chunk reader int interlac method header chunk interlac method interlac method png ihdr chunk read interlac imag els read interlac imag decod stream assert imag data decod stream check adler answer number byte word align row pixel data int align byte row return byte row header chunk width answer number byte row imag data row byte align imag bit depth byte unus bit row valu bit undefin int byte row return byte row header chunk width answer number byte repres pixel valu depend imag color type bit depth note method imag pixel size isn byte align int byte pixel int bit pixel header chunk bit pixel return bit pixel answer number byte row pixel width row byte align imag bit depth byte unus bit row valu bit undefin int byte row int row width pixel int bit pixel header chunk bit pixel int bit row bit pixel row width pixel int bit byte return bit row bit byte bit byte read frame interlac data updat imag data notifi imag loader listen frame load void read interlac frame int row interv int column interv int start row int start column int frame count int width header chunk width int align byte row align byte row int height header chunk height start row height start column width return int pixel row width start column column interv column interv int byte row byte row pixel row byte row byte byte row byte row byte byte row byte current row row byte row row int row start row row height row row interv byte filter type decod stream decod byte int col col byte row col current row col decod stream decod byte filter row current row row filter type header chunk bit depth int byte pixel byte pixel int data offset row align byte row start column byte pixel int row offset row offset current row length row offset byte pixel int byte offset byte offset byte pixel byte offset data data offset byte offset current row row offset byte offset data offset column interv byte pixel els int bit pixel header chunk bit depth int pixel byte bit pixel int column start column int row base row align byte row int valu mask int bit pixel valu mask valu mask int max shift bit pixel int byte offset byte offset current row length byte offset int bit offset max shift bit offset bit offset bit pixel column width int data offset row base column bit pixel int valu current row byte offset bit offset valu mask int data shift max shift bit pixel column pixel byte data data offset valu data shift column column interv current row current row row row row row row row row row set imag data valu data imag data fire interlac frame event frame count read pixel data interlac imag data stream void read interlac imag read interlac frame read interlac frame read interlac frame read interlac frame read interlac frame read interlac frame read interlac frame fire event listen interlac frame load final frame true imag finish load fals frame void fire interlac frame event int frame count loader listen imag data imag imag data imag data clone boolean final frame frame count loader notifi listen imag loader event loader imag frame count final frame read pixel data interlac imag data stream updat imag data reflect data void read interlac imag int data offset int align byte row align byte row int byte row byte row byte row byte byte row byte row byte byte row byte current row row byte row row int row row header chunk height row byte filter type decod stream decod byte int col col byte row col current row col decod stream decod byte filter row current row row filter type system arraycopi current row data data offset byte row data offset align byte row current row current row row row row row row row row row set imag data valu data imag data doe support bit depth color format convert bit data bit data correct multipli bit valu valu fast drop byte bit valu static void compress bit depth bit depth byte sourc int sourc offset byte destin int destin offset int number valu doubl multipli compat pow compat pow int number valu int sourc index sourc offset int destin index destin offset int valu sourc sourc index sourc sourc index byte compress valu byte valu multipli byte compress valu sourc sourc index destin destin index compress valu doe support bit depth color format convert bit data bit data correct multipli bit valu valu fast drop byte bit valu static int compress bit depth bit depth int valu doubl multipli compat pow compat pow byte compress valu byte valu multipli return valu support filter type type appli row imag data method unfilt row base filter type void filter row byte row byte previous row int filter type int byte offset header chunk filter byte offset switch filter type case png ihdr chunk break case png ihdr chunk int byte offset row length int current row int left row byte offset row byte current left break case png ihdr chunk int row length int current row int abov previous row row byte current abov break case png ihdr chunk int row length int left byte offset row byte offset int abov previous row int current row row byte current left abov break case png ihdr chunk int row length int left byte offset row byte offset int abov left byte offset previous row byte offset int abov previous row int math ab abov abov left int math ab left abov left int math ab left abov left abov abov left int preductor preductor left els preductor abov els preductor abov left int current valu row row byte current valu preductor break 